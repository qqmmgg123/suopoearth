<!DCOTYPE html>
<html lang="zh-cms-Hans">
<head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <title><%= title %></title>
    <!-- 通用样式 -->
    <link href="/css/style.css" rel="stylesheet" type="text/css" />
    <!--[if lt IE 9]>
    <link href="/css/compatible.css" rel="stylesheet" type="text/css" />
    <![endif]-->
</head>
<body>
    <% include header.html %>
    <div class="container">
        <div class="signup-area">
            <form id="signup-form" action="/signup" autocomplete="off" method="post" novalidate>
                <div class="signup-error"><%= info %></div>
                <!--<div>-->
                    <!--<p class="label"><label for="email">邮箱</label></p>-->
                    <!--<p class="field"><input type="email" name="email" id="email" placeholder="输入邮箱" required></p>-->
                <!--</div>-->
                <div>
                    <p class="label"><label for="username">邮箱</label></p>
                    <p class="field"><input type="email" name="username" id="username" placeholder="输入邮箱" required></p>
                    <p class="validate-error" style="display: none;"></p>
                </div>
                <div>
                    <p class="label"><label for="nickname">昵称</label></p>
                    <p class="field"><input type="text" name="nickname" id="nickname" placeholder="输入昵称" required></p>
                    <p class="validate-error" style="display: none;"></p>
                </div>
                <div>
                    <p class="label"><label for="password">密码</label></p>
                    <p class="field"><input type="password" name="password" id="password" placeholder="输入密码" required></p>
                    <p class="validate-error" style="display: none;"></p>
                </div>
                <!--<div>-->
                    <!--<p class="label"><label for="password_report">密码确认</label></p>-->
                    <!--<p class="field"><input type="password" name="repassword" id="password_repeat" placeholder="再次输入密码" required></p>-->
                <!--</div>-->
                <div>
                <button id="signup-btn" type="submit" class="btn btn-primary">注册</button>
                <a class="btn btn-default" href="/signin" role="button">登录 ></a>
                </div>
            </form>
        </div>
    </div>
    <% include footer.html %>
    <% include create.html %>
</body>
<script src="/js/jquery.min.js" type="text/javascript"></script>
<script src="/js/common.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function() {
        $("#signup-btn").click(function(e) {
            var formData = {};
            var validate = true;
            var $form = $('#signup-form');
            $form.find('input').each(function() {
                var $this = $(this);
                var val = $this.val();
                var $field = $this.closest('.field');
                var label = $field.prev('p.label').find('label').text();
                var $tips = $field.next('.validate-error');

                // 判断是否为空
                if ($.trim(val).length === 0) {
                    $tips.text(label + "未填写").show();
                    validate = false;
                    return;
                }else{
                    $tips.text("").hide();
                }

                var isValid = true;
                var errorText = "";
                // 判断是否有效
                switch(this.name) {
                    case 'username':
                        if (!common.isValidEmail(val)) {
                            errorText = label + "的格式书写错误";
                            validate = false;
                            isValid = false;
                        }
                        break;
                    case 'nickname':
                        if (!common.isNickName(val)) {
                            errorText = label + "须是2~12个小写字母或数字或中文组成";
                            validate = false;
                            isValid = false;
                        }
                        break;
                    case 'password':
                        if (!common.isPassword(val)) {
                            errorText = label + "须是6~16个字符的小写字母或数字组成";
                            validate = false;
                            isValid = false;
                        }
                        break;
                    default:
                        break;
                }
                if (!isValid) {
                    $tips.text(errorText).show();
                }else{
                    $tips.text("").hide();
                }
                formData[this.name] = $(this).val();
            });
            
            if (validate) {
                $form.replaceWith("<p>正在发送认证邮件至您的邮箱...请稍等</p>");
            }
            return validate;
        });
    });
</script>
</html>
